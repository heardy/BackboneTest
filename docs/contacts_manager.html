<!DOCTYPE html>

<html>
<head>
  <title>contacts_manager.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="contacts_manager.html">
                contacts_manager.js
              </a>
            
              
              <a class="source" href="hello_world.html">
                hello_world.js
              </a>
            
              
              <a class="source" href="todo.html">
                todo.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>contacts_manager.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="function"><span class="keyword">function</span> <span class="params">($)</span> {</span>
<span class="keyword">var</span> contacts = [
	{ name: <span class="string">"Contact 1"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"family"</span> },
	{ name: <span class="string">"Contact 2"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"family"</span> },
	{ name: <span class="string">"Contact 3"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"friend"</span> },
	{ name: <span class="string">"Contact 4"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"colleague"</span> },
	{ name: <span class="string">"Contact 5"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"family"</span> },
	{ name: <span class="string">"Contact 6"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"colleague"</span> },
	{ name: <span class="string">"Contact 7"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"friend"</span> },
	{ name: <span class="string">"Contact 8"</span>, address: <span class="string">"1, a street, a town, a city, AB12 3CD"</span>, tel: <span class="string">"0123456789"</span>, email: <span class="string">"anemail@me.com"</span>, type: <span class="string">"family"</span> }
];</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Placeholder model</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> Contact = Backbone.Model.extend({
	defaults: {
		photo: <span class="string">"./img/placeholder.png"</span>
	}
});

<span class="keyword">var</span> Directory = Backbone.Collection.extend({
	model: Contact
});

<span class="keyword">var</span> ContactView = Backbone.View.extend({
	tagName: <span class="string">"article"</span>,
	className: <span class="string">"contact-container"</span>,
	template: $(<span class="string">"#contactTemplate"</span>).html(),

	render: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">var</span> tmpl = _.template(<span class="keyword">this</span>.template);
		<span class="keyword">this</span>.$el.html(tmpl(<span class="keyword">this</span>.model.toJSON()));
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}
});

<span class="keyword">var</span> DirectoryView = Backbone.View.extend({
	el: $(<span class="string">"#contacts"</span>),
	initialize: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">this</span>.collection = <span class="keyword">new</span> Directory(contacts);
		<span class="keyword">this</span>.render();
		<span class="keyword">this</span>.$el.find(<span class="string">"#filter"</span>).append(<span class="keyword">this</span>.createSelect());
		<span class="keyword">this</span>.on(<span class="string">"change:filterType"</span>, <span class="keyword">this</span>.filterByType, <span class="keyword">this</span>);
		<span class="keyword">this</span>.collection.on(<span class="string">"reset"</span>, <span class="keyword">this</span>.render, <span class="keyword">this</span>);
	},
	render: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">var</span> that = <span class="keyword">this</span>;
		<span class="keyword">this</span>.$el.find(<span class="string">"article"</span>).remove();
		_.each(<span class="keyword">this</span>.collection.models, <span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
			that.renderContact(item);
		}, <span class="keyword">this</span>);
	},
	renderContact: <span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
		<span class="keyword">var</span> contactView = <span class="keyword">new</span> ContactView({
			model: item
		});
		<span class="keyword">this</span>.$el.append(contactView.render().el);
	},

	getTypes: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">return</span> _.uniq(<span class="keyword">this</span>.collection.pluck(<span class="string">"type"</span>), <span class="literal">false</span>, <span class="function"><span class="keyword">function</span> <span class="params">(type)</span> {</span>
			<span class="keyword">return</span> type.toLowerCase();
		});
	},
	createSelect: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
		<span class="keyword">var</span> select = $(<span class="string">"&lt;select/&gt;"</span>, {
			html: <span class="string">"&lt;option value='all'&gt;All&lt;/option&gt;"</span>
			});
		_.each(<span class="keyword">this</span>.getTypes(), <span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
			<span class="keyword">var</span> option = $(<span class="string">"&lt;option/&gt;"</span>, {
				value: item.toLowerCase(),
				text: item.toLowerCase()
			}).appendTo(select);
		});
		<span class="keyword">return</span> select;
	},
	events: {
		<span class="string">"change #filter select"</span>: <span class="string">"setFilter"</span>
	},
	setFilter: <span class="keyword">function</span>(e){
		<span class="keyword">this</span>.filterType = e.currentTarget.value;
		<span class="keyword">this</span>.trigger(<span class="string">"change:filterType"</span>);
	},
	filterByType: <span class="keyword">function</span>(){
		<span class="keyword">if</span> (<span class="keyword">this</span>.filterType === <span class="string">"all"</span>) {
			<span class="keyword">this</span>.collection.reset(contacts);
		} <span class="keyword">else</span> {
			<span class="keyword">this</span>.collection.reset(contacts, { silent: <span class="literal">true</span> });

			<span class="keyword">var</span> filterType = <span class="keyword">this</span>.filterType,
				filtered = _.filter(<span class="keyword">this</span>.collection.models, <span class="function"><span class="keyword">function</span> <span class="params">(item)</span> {</span>
				<span class="keyword">return</span> item.get(<span class="string">"type"</span>).toLowerCase() === filterType;
			});

			<span class="keyword">this</span>.collection.reset(filtered);
		}
	}
});

<span class="keyword">var</span> directory = <span class="keyword">new</span> DirectoryView();

} (jQuery));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
